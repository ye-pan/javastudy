# 重构——改善既有代码的设计

## 有一次从头开始

三个月前已经读过一遍了，但去尝试精读一些书籍，是从六月开始的，所以我决定重读一遍。只为将所有重构手法了然于胸，将重构做到如书中所描绘的，
就是日常 开发工作。为什么我要这么重视重构以及重构的基本手法，我见过了因为项目的烂代码而不得不重写的，也见到过 写过烂代码，但我希望以后的
我，就算是真的产生了烂代码，我也会去经常性的重构它，直到完善为止。书中所描绘的有讲究的，一次一小步的重构，以后的开发中我也需要做到。

## 前言

重构：在不改变代码外在行为的前提下，对代码做出修改，以改进程序的内部结构。重构是一种经千锤百炼形成的有条不紊的程序整理方法，可以最大限度
的减少整理过程中引入错误的概率。本质上说，重构就是在代码写好之后改进它的设计。

## 重构——第一个案例

重构就是以微小的步伐修改程序，如果你犯下错误，很容易便可发现它。

任何一个傻瓜都能够写出计算机可以理解的代码，唯有写出人类容易理解的代码，才是优秀的程序员。

### 用到的重构手法

1. extract method
2. rename 
3. move method 
4. Replace Temp with Query
5. Replace Conditional with Polymorphism
6. Self Encapsulate Field 
7. Replace Type Code With State/Strategy

### 总结

开篇一个demo，向我们展示了重构，是什么，平时开发怎么做，有什么效果。跟着这个demo做了，对重构有了一个初步认识，需要接下来继续学习。其中，
这个例子中展现的所有重构手法，均已经亲自操作过，对为什么这么做也了解了。

## 重构原则

### 何谓重构

1. 对软件内部结构的一种调整，目的是在不改变软件可观察的前提下，提高其可理解性，降低修改成本。
2. 使用一系列重构手法，在不改变可观察行为的前提下，调整其结构。

两顶帽子：
使用重构技术开发软件时，你把自己的时间分配给两种截然不同的行为：添加新功能，以及重构。添加新功能时，你不应该修改既有代码，只管添加新功能。
通过测试（并让测试正常运行），你可以衡量自己的工作进度。重构时你就不能再添加新功能，只管改进程序结构，此时，你不应该添加任何测试（除非
发现先前遗漏的东西），只在绝对必要（用以处理接口变化）时，才修改测试。

### 为何重构

* 重构改进软件设计：如果没有重构，软件设计会逐渐腐败变质。
* 重构使软件更容易理解：
* 重构帮助找到bug：
* 重构提高变成速度：

### 何时重构

重构本来就不是一件应该特别拨出时间做的事情，重构应该随时随地的进行，你不应该为重构而重构，你之所以重构，是因为你想做别的什么事，而重构
可以帮助你把那些事做好。

* 三次法则：
* 添加功能时重构：
* 修补错误时重构：
* 复审代码时重构：

### 总结

这章是对重构定义的内容，作者描述的很多场景，现在的我甚至都还不能体会。但只要通过这些细节手法，一次一小步的前进，我终究也会达到作者书中
所描绘的层次。书中的一句话已经做了很到位的总结“我不是个伟大的程序员，我只是个有着一些优秀习惯的好程序员”。

## 代码的坏味道

这一章太重要了，专门整理了一个文档。参看[代码的坏味道](代码的坏味道.md)。





